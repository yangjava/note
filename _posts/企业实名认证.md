# 企业实名认证手册

实名认证功能目前广泛应用于互联网金融、交易平台、游戏等行业，随着关于互联网法律和监管的深入发展，长远来看任何一个为用户提供日常需求服务的互联网平台都离不开实名认证功能。

## 概述

实名认证是对用户资料真实性进行的一种验证审核。有助于建立完善可靠的互联网信用基础。一般有银行卡认证和身份证认证两种方式，可以避免一部分网络诈骗。

我们知道，互联网的用户行为特征之一就是匿名性，互联网用户使用产品时一般是以虚拟的身份在进行操作和交流，这有时候会带来一些问题。

举例如下：

- 涉及到金融功能的产品，用户操作会涉及到资金往来等经济行为。匿名性会使金融监管难以介入，诱发洗钱、诈骗、盗取等金融犯罪的发生（可参考比特币）。
- 部分产品法律上要求特定人群才能参与，如一些网络游戏要求成年人才能参与娱乐，未经实名认证可能导致一些不适合使用产品的人群也参与到产品使用。
- 涉及到交易买卖的平台，对于出售方的企业如果不进行实名认证，可能会导致高仿、山寨、假冒伪劣等产品的出售损害到购买方的利益，进而诱发市场风险和法律风险。

由以上可以看出实名认证功能对很多产品的必要性，另外，实名认证能够使产品和运营对于用户的人群、信息进行分析，更好地描绘用户画像并针对性进行一系列优化和服务，故对于产品本身也是大有益处。

当然，实名认证会带来操作复杂化，以及信息泄露和信息安全等问题，会很大程度降低客户体验，影响客户对产品的使用。所以采用何种形式的实名认证，以及如何进行实名认证交互设计至关重要。

## 原理

目前国内提供实名认证功能的有基于公安部接口的认证，基于银联接口的认证、基于通讯运营商接口的认证及基于工商部接口的企业认证。

企业实名认证有企业三要素、企业四要素、企业打款认证三种方式，也有一些实名认证方式是上述几种方式的结合运用。

## 设计

### 企业三要素

企业三要素指企业名称、企业代码、法人代表姓名三项基本信息。因为目前企业该三项信息都能通过互联网公开渠道获取到，因此企业三要素认证的严格性不强。

使用的话一般要求企业客户上传营业执照扫描件作为辅助的实名认证证明，营业执照同样可以OCR识别功能。

### 企业四要素

企业四要素指企业名称、企业代码、法人代表姓名、法人代表身份证号，可以看成是企业三要素+法人代表身份证二要素的结合认证。由于法人代表身份证号除了企业经营者较难获取，所以企业四要素一般可作为企业客户的实名认证方式。

### 企业打款认证

企业打款认证指用户提供企业名称、企业代码、法人代表姓名、对公银行账号信息，认证机构完成信息校验后，会向企业对公账号打入一笔金额（一般在1元以下），企业收到款项后将收到款项的金额在页面进行填充，如：金额正确则完成实名认证。企业打款认证是严格性很高的实名认证，一般用在需要谨慎确认企业身份的产品上面。

## 实现

企业实名认证可以通过多种技术手段实现

### 国家企业信息公示系统

**国家企业信息公示系统**http://www.gsxt.gov.cn/index.html

### 企查查

企业三要素验证

验证公司名，法人，注册号或统一信用代码，是否匹配

| 信息     | http://api.qichacha.com/ECIMatch/CompanyVerify               |
| -------- | ------------------------------------------------------------ |
| 接口地址 | http://api.qichacha.com/ECIMatch/CompanyVerify               |
| 支持格式 | JSON/XML                                                     |
| 请求方式 | GET                                                          |
| 请求实例 | http://api.qichacha.com/ECIMatch/CompanyVerify?key=ApiKey&regNo=regNo&companyName=companyName&frname=frname |

示例代码

```java
/**
 * 版权申明: 苏州朗动科技有限公司<br>
 * 项目描述: 企查查-接口平台<br>
 * 该接口调用demo仅供学习参考
 */
package org.ld.httpGetDemo;

import static java.lang.System.out;

import java.io.IOException;
import java.util.regex.Pattern;

import org.apache.commons.codec.digest.DigestUtils;
import org.apache.http.client.methods.HttpHead;
import org.json.JSONException;
import org.json.JSONObject;

import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.ObjectMapper;

/**
 * 
 * 描述 http请求处理模块<br>
 * 
 * @author szld<br>
 * @version 1.0 <br>
 *          日期：2019年7月31日 下午2:23:41
 */
public class MainApp {
	// 请登录http://yjapi.com/DataCenter/MyData
	// 查看我的秘钥 我的Key
	private static final String appkey = "我的接口:我的Key";
	private static final String seckey = "我的接口:我的秘钥";

	public static void main(String[] args) {
		String reqInterNme = "http://api.qichacha.com/ECIV4/Search";
		String paramStr = "keyword=新疆庆华能源集团有限公司";
		String status = "";
		try {
			// auth header setting
			HttpHead reqHeader = new HttpHead();
			String[] autherHeader = RandomAuthentHeader();
			reqHeader.setHeader("Token", autherHeader[0]);
			reqHeader.setHeader("Timespan", autherHeader[1]);
			final String reqUri = reqInterNme.concat("?key=").concat(appkey).concat("&").concat(paramStr);
			String tokenJson = HttpHelper.httpGet(reqUri, reqHeader.getAllHeaders());
			out.println(String.format("==========================>this is response:{%s}", tokenJson));

			// parse status from json
			status = FormartJson(tokenJson, "Status");
			out.println(String.format("==========================>Status:{%s}", status));
			if (!HttpCodeRegex.isAbnornalRequest(status)) {
				PrettyPrintJson(tokenJson);
			}
		} catch (Exception e1) {
			e1.printStackTrace();
		}
	}

	// 获取返回码 Res Code
	static class HttpCodeRegex {
		private static final String ABNORMAL_REGIX = "(101)|(102)";
		private static final Pattern pattern = Pattern.compile(ABNORMAL_REGIX);
		protected static boolean isAbnornalRequest(final String status) {
			return pattern.matcher(status).matches();
		}
	}

	// 获取Auth Code
	protected static final String[] RandomAuthentHeader() {
		String timeSpan = String.valueOf(System.currentTimeMillis() / 1000);
		String[] authentHeaders = new String[] { DigestUtils.md5Hex(appkey.concat(timeSpan).concat(seckey)).toUpperCase(), timeSpan };
		return authentHeaders;
	}

	// 解析JSON
	protected static String FormartJson(String jsonString, String key) throws JSONException {
		JSONObject jObject = new JSONObject(jsonString);
		return (String) jObject.get(key);
	}

	// pretty print 返回值
	protected static void PrettyPrintJson(String jsonString) throws JSONException {
		try {
			ObjectMapper mapper = new ObjectMapper();
			Object obj = mapper.readValue(jsonString, Object.class);
			String indented = mapper.writerWithDefaultPrettyPrinter().writeValueAsString(obj);
			out.println(indented);
		} catch (JsonProcessingException e) {
			e.printStackTrace();
		} catch (IOException e) {
			e.printStackTrace();
		}
	}
}
```

