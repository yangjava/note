# 聚合支付

聚合支付是指聚合了主流的微信、支付宝、百度钱包，银联等支付方式为一体，提供一个聚合类型的二维码给商户进行收款，具有便捷、高效的特性。聚合支付平台不涉及资金的所有权，不进行清算，只做技术上的渠道整合，且无需支付牌照。

 在移动支付发展的如日中天的中国，聚合支付已经成为了一种新兴的支付方式，成为未来支付行业里的大趋势。但是，仍然有一些小企业和个体商户有着这样一个疑惑，既然第三方支付都已经如此发达快速了，微信和支付宝就基本可以满足所有顾客的支付需求，为什么还要做聚合支付呢?它究竟好在哪里? 

具体可以体现在以下这几点：

  一、商户可以通过聚合支付来挽回客人。比如某个客人拿着手机打算到商户店里消费时，但是手机没安装支付宝，想使用其他支付方式付款，而商户的店里却只支持支付宝，这时面对自己所不支持的二维码支付，商户也只让客人使用现金或者直接告诉他没有这种支付方式，而无奈的失去这个客人。

  二、商户可以利用聚合支付来提升自己的经营效率。很多商户的收银台上都摆满了各种各样不同的收款二维码，除了严重占据地方外，这也让消费者找起来非常费劲，而且商户如果想查看每个不同支付账户的到账情况的话，同样会很凌乱繁琐。但是如果使用了聚合支付后，不管钱到了哪个账户，商户都可以及时随时查看账单报表和经营报表，省时省力且高效。

  三、第三方支付的限制。可能有不少人并不知道第三方支付收款是有限制，这也成为众多商户主动寻找聚合支付服务商的一大重要原因。比如，做自媒体营销或消费金融产品等拓展业务，因为第三方支付基本上只是提供收款收银这个单一的业务，并无法满足商户大量的额外需求。

  四、聚合支付已经大势所趋。你可能会发现，无论是大型的超市商场，还是街头小巷里的小吃店、便利店，几乎所有的消费场所都已经用上了聚合支付，聚合支付正在以一种无可阻挡的势头迅速蔓延整个支付市场。如果你是一个老板商户，还不给自己的店里接入聚合支付的话，那真的就有点太“out”了，而且消费者使用的支付方式越来越多样化，第三方支付所产生的严重“碎片化”特性，也让你不得不接入更有利有高效的聚合支付。

 聚合支付：也称“融合支付”，是指只从事“支付、结算、清算”服务之外的“支付服务”，依托银行、非银机构或清算组织，借助银行、非银机构或清算组织的支付通道与清结算能力，利用自身的技术与服务集成能力，将一个以上的银行、非银机构或清算组织的支付服务，整合到一起，为商户提供包括但不限于“支付通道服务”、“集合对账服务”、“技术对接服务”、“差错处理服务”、“金融服务引导”、“会员账户服务”、“作业流程软件服务”、“运行维护服务”、“终端提供与维护”等服务内容，以此减少商户接入、维护支付结算服务时面临的成本支出，提高商户支付结算系统运行效率的，并收取增值收益的支付服务。 

快捷支付、余额宝、微信红包、扫码付款、敬业福、奖励金……回顾这五年，支付宝、微信，这两款保持在国内移动互联网最高水平线的产品联袂奉献了不少老百姓都耳熟能详的精彩大戏。然而“外行看热闹，内行看门道”，作为一个产品人，应该如何解读过去的五年？又如何读懂即将到来的支付战争下半场呢？

**一张图看懂移动支付**



![img](https:////upload-images.jianshu.io/upload_images/5114257-74fda6fbb3692f27.png?imageMogr2/auto-orient/strip|imageView2/2/w/864/format/webp)

移动支付业务由三层结构组成：支付服务、支付产品、支付应用。

支付服务是支撑支付业务运转的基础，包含了资金账户体系、资金流的清结算、账单对账平账、支付安全风控、资产损失处置等等。在具体的架构设计和实现方案上，支付宝、微信支付（财付通）、京东金融等各家互联网公司都有所差异，但设计的初衷都是为了能够应对高并发的支付请求、提供安全的支付环境、减少资产损失、弹性应对事故。

完善的支付服务具有很高的技术门槛和实现复杂度，支付宝在这一领域代表了国内的最高水准，也符合用户对支付宝形成的最安全、最专业的支付平台印象。而财付通经过长期的积累，也具有接近支付宝的服务水平，为微信支付的崛起提供了基础的保障，才得以让其利用春节红包一炮而红。

基于支付服务，第三方支付公司包装出一系列的支付产品，用于应对上层各种支付应用场景。这里不得不提到支付宝所发明的快捷支付，通过三方签约的方式，节省了用户每次打开网银跳转到银行进行支付的麻烦。而正是得益于支付宝这项突破性的创新，才使第三方支付逐渐形成主流，也得以让移动支付成为可能。

在支付产品的上层，则是普通用户能够感知到的支付应用，也就是很多产品人口中的支付场景。在这一层，成千上万的支付应用可以划分为三大类：电商支付、关系链支付、线下支付。

电商支付，其实并不只是包含淘宝、京东等购物平台，而是所有由用户发起、向一个商业平台进行支付行为的应用总称。抛开大大小小传统意义上的电商，主要还包括了电影票、团购券、滴滴打车等O2O服务，以及手机充值、生活缴费、资金理财、游戏充值、公益捐款等消费场景。

关系链支付，顾名思义即用户之间进行资金流通的支付应用，著名的微信红包，以及传统的转账、收款等都包含在这里。

而线下支付，是用户在线下通过某种方式唤起支付行为的过程，可能把钱支付给个人，也可能把钱支付给企业，从最早的餐饮、娱乐业消费，逐步扩展到商超、交通、医疗等各个行业，在一二线城市已经成为了很多人的主要支付手段。

从这张图中不难看出，移动支付的两个巨头业务遍及所有支付应用类型，在抢夺上层场景的同时，也促使双方不断推出创新性的支付产品。五年的支付战争史，正是双方在这三块阵地上你来我往的过程。

**上半场：从支付产品创新到支付应用创新**



![img](https:////upload-images.jianshu.io/upload_images/5114257-5e37a0049c5dcb26.png?imageMogr2/auto-orient/strip|imageView2/2/w/881/format/webp)

在微信支付诞生之前，支付宝始终是第三方支付领域最有创造力的玩家。

快捷支付这个名字，是支付宝篆刻在中国互联网历史上极为浓厚的一笔，移动支付后续五年的发展，都建立在这项发明的基础之上。2012年双十一之后，刚刚出生不到一年的快捷支付就迅速突破一亿用户，在支付产品上尝到了甜头的支付宝，时至今日仍然站在这一领域创新的最前沿：声波付、近场付、刷脸付、甚至概念化的空付，花样繁多也极具科技感。

另一方面，由于支付宝脱胎于淘宝，使其天然拥有了第一个、也是最大的支付应用。说到支付应用，就不得不提支付宝的另一项突破性创新：余额宝。2013年以来，作为第二个拳头支付应用，其截止2017年二季度超过1.5万亿的规模早已突破了货币基金行业的旧常识。实际上无论是理财通还是百度理财，至今仍亦步亦趋模仿着这款经久不衰的产品。

其实抛开淘宝和余额宝这两张王牌，支付宝还早早引入了生活缴费、手机充值、淘票票等一系列支付应用，一时间几乎囊括了所有用户能够进行移动支付的可能性，也正因与此，2013年市场份额占到80%以上的支付宝走向了巅峰。

时至今日回过头来看，支付宝在鼎盛时期所有的份额都集中在电商支付应用，而且直到今天在这一领域其仍然具有难以动摇的优势。可以说微信支付后续的成功，不是因为支付宝在旧阵地上做的不好，而是在另外两块新战场上给了微信机会。

2014年的微信红包是每一个产品经理都津津乐道的故事，站在产品的角度，已经有很多人分析过这款设计细节的成功之处。而如果从支付行业整体来看，其实微信的最精妙之处还是从战略上绕开了电商支付应用的正面战场，在本来还没有形成气候的关系链支付应用上别开生面。

理解了关系链支付应用的概念，就会发现支付宝当年“做社交”的故事是很自然且不能说是错误的选择。在电商支付应用优势巨大，线下支付应用尚未完成用户培育的情况下，支付宝没有道理在这一整类业务上束手就擒。为了挽救关系链支付应用的败局，支付宝在敬业福、生活圈、蚂蚁森林等一系列产品上的努力其实可圈可点，但仍然难以抵挡微信在关系链上巨大的优势。

但微信从2015年开始，又将精力转向了线下支付这一新领域。2016年年中，微信线下支付份额首次超越支付宝，在这种严峻的形势下，与其说是“女大学生圈”事件让支付宝放弃社交，不如说是支付宝意识到关系链支付在三类支付中体量最小、难度最高，而线下支付正在开启一个远超电商支付和关系支付之和的庞大战局，值得支付宝拿出全部本领迎接一场决战。

**下半场：正面决战线下收单**

国际化、线下收单、小程序，这是支付战争下半场的三块主要阵地。

根据艾瑞公布的数据，2017年一季度国内支付市场份额呈现出进一步向两强集中的趋势，其中支付宝增长至54%，微信增长至40%。这主要得益于线下支付市场的持续扩大，而且可以预见的是，线下支付市场的总规模终将超过线上电商支付和关系链支付之和。

9月25日，被称为“线下BD终极KPI”的星巴克终于支持支付宝支付。而就在本月初，微信和支付宝相继宣布在地铁、公交领域的大动作，而且获得了两位马老板的亲自站台。更早的8月份，微信和支付宝相继推出无现金社会活动，承受着巨大成本强推支付奖励金，向全社会普及线下移动支付的理念。可以说，线下支付应用的决战已经进入白热化，可以预见的半年到一年以内，两个超级平台的主要产品创新，都会围绕争抢线下支付应用份额展开。

值得注意的是，除了在应用层厮杀，支付宝仍然没有放弃在支付产品层实现突破性创新重现当年“快捷支付”壮举的可能。“空付”概念随着机器视觉和深度学习的快速发展，正在逐步成为可能，无需打开手机即可完成支付的无人停车场证明了支付宝在这一领域走在前沿的实力。

而另一方面，微信其实并不仅仅把目光放在线下支付的战斗上，小程序作为国内移动互联网今年截至目前最重要的产品，正在悄悄为微信带来攻破支付宝电商支付优势的可能。

已经进行了5年的移动支付之战，时至今日仍然是产品人最值得关注的业务领域，也是产品策略最多、参与玩家最强的领域。除了文中所述微信和支付宝所引领的主要战场，其他玩家在这场支付战争中如何生存？尚未入局的准巨头是否还有参战的机会？后续笔者会陆续分析这些更细分的领域机会。

 处于产品变现的时代，了解产品的支付逻辑已经是越来越多的产品经理的基本技能要求。因为支付对于任何一个涉及到交易的产品都是非常重要的一个环节。然而，几乎所有的产品都只是想让用户将“买买买”进行到底，却未有认真地构想支付流程的合理化设计。 

7月21日20:30，「起点学院公开课」邀请到了从事了六年移动支付的老兵——Ping++产品总监谢勇 ，与我们拆解了支付流程合理化设计的秘密，打通了产品支付的奇经八脉。

**以下为分享正文，由人人都是产品经理团队笔记小组成员@龙汶 依据嘉宾现场分享内容整理，编辑有修改：**

大家晚上好，非常感谢起点学院公开课的邀请，由我为大家带来今天的分享。我是谢勇，大家也可以叫我“花生”，目前是Ping++ 支付产品负责人，主要负责支付产品的规划与设计。今天和大家分享的主题是：**企业支付产品设计的个人心得**。所以，今天我主要是**从业务层的角度上去分享，企业如何设计支付产品。**

## 企业端支付方式的发展变迁

![gongkaike_160721_ppt_ (1)](http://image.woshipm.com/wp-files/2016/08/gongkaike_160721_ppt_-1.jpg)

### 银行网关支付

首先看一下企业端支付方式的发展变迁，最早期的是银行网关的支付。所谓银行网关支付就是一些第三方支付公司作为代理接入一堆的银行网关，用户在网关页面选择银行，跳转到第三方支付平台，然后重新定向到电子银行的官网使用网银完成支付。我们一般说的网关支付，是指在PC端的在线支付，这种支付接入十分复杂，而且各家银行网关的接口也没有标准化。支付宝早期就是一一对接了这些银行网关接口，为商户提供统一的支付入口。比如以前的淘宝购物，用户在跳转支付页面后需要手动在银行列表选择，这种操作过程非常麻烦，而且体验也十分不好。

### 银行快捷支付

之后，企业端的支付方式进化到快捷支付。说到快捷支付，首先要说一个定义“代扣”，代扣一般是指用户通过线上或线下柜台的方式签署一个双方协议，分别是用户、商户、银行的双方协议，授权商户可以从用户的银行账户扣钱。典型的应用场景：比如水、电、煤的代扣，保理费的定期扣除。而本质上快捷支付是这个代扣服务（对私）的包装。

传统代扣服务授权过程比较麻烦，而且行业的应用场景限制的比较多，比如：只对某些实名行业开放。快捷支付对线上小额支付的需求场景简化了授权过程，一般它只要完成身份证、手机号的实名认证就可以，同时通过下发短信验证码形式来完成消费确认。这种体验较好地平衡了支付方式的安全性与便捷性。

### 第三方支付账户

其次，第三方支付公司还提供了支付账户的支付方式。所谓第三方支付账户的支付方式简单理解就是大家常用的支付宝余额、微信零钱，他们在小额支付的场景中较大的提升了用户支付体验。但是这两种，像快捷支付和第三方支付账户的支付方式，由于现在支付渠道碎片化日益严重，而且各个渠道间的申请流程和接口差异化等等原因，在企业接入服务时会有很多痛点，这也是最后聚合支付的价值所在，聚合支付的价值简单理解就是，可以一点接入所有主流的支付渠道，可以一站式的提供与支付相关的服务。以上就是一个企业支付发展变迁史。

## 企业如何接入支付服务

我觉得对于一些中小型企业，一般可以从三点入手：第一选择支付渠道；第二选择支付产品；第三接入支付系统。

### 1、支付渠道

我们可以看一下主流支付渠道有支付宝、微信支付、银联、银企直联等其他第三方支付。放弃主流意味着冒险，以上支付渠道涵盖了当下绝大部分的支付场景，覆盖率应该超过90%以上。支付宝、微信支付和银联大家相对都比较熟悉，接下来给大家简单地介绍一下银企直联。

所谓银企直联就是银行为企业打包开放一系列接口，企业在合作银行开通企业账户，消费者可以在选择支付通道时，选择相应的银行支付，支付的资金是直接到企业的银行账户，资金的流出也是通过这个企业账户。这种支付方式对于企业来说最大的优势在于，资金沉淀在企业账户上，但是他有一个前置条件，企业必须有一个较强的银行公关能力，把主流银行的银企直联都搞定，才能实现较好的用户体验。

一般对于中大型的企业而言，一般会采取大行直营的方式，直接对接五大国有商业银行以及部分全国性股份制商业银行。

**对于选择支付渠道，主要考虑三个要素分别是成本、用户体验、订单转换率。**

![img](http://image.woshipm.com/wp-files/2016/08/gongkaike_160721_ppt_-2.jpg)

一个合适的支付产品，它的理想状态是用户体验好，成本很低，订单转换率很高。但是，同时满足这三个条件的支付产品几乎是不能存在。以最流行的支付宝为例，随着交易额越来越大，规模越来越大，手续费也越来越高。所以企业在进行渠道选择的时候需要根据实际情况做一个权衡。

**（1）成本**

下面就这三点展开分别阐述一下：渠道成本，成本大致分为两块，一块是支付渠道的手续费，另外一块是支付接入时候的人力投入加上运营维护的成本，这两块也难以同时满足，需要根据实际的支付场景寻求最优解。我们以一个电商平台为例子，一个电商平台可能有B2C、B2B两种支付需求。2C项目的客单价都不会太高，他是一个小额支付领域，支付手续费相对也比较少，那么主要的支付产品就是支付宝、微信支付、银联等这些主流的支付产品。但是对于2B项目的客单价相对比较高，一般都是过万。他可能涉及到一些企业结算时候商家、平台、物流资金分账需求，所以为了减少手续费，并且简化财务工作，在选择支付渠道的时候，可能会选择其他的第三方支付。这些第三方机构的优势在于：第一费率可能比较低，第二可以满足一些商家进制化的需求，比如，分账可以极大的减少财务人员的投入。

以下是目前主流支付渠道的费率统计：

![img](http://image.woshipm.com/wp-files/2016/08/gongkaike_160721_ppt_-6.jpg)

在此，我简单汇总了主流支付渠道的费率：支付宝的费率是千六，除了一些特殊行业相对较高一点外，绝大部分的费率都是千六。支付宝的结算周期，用户付款后，就实时到了商户支付宝企业账号，商户可以自行选择转账或提现。

微信支付分实物类和虚拟类，实物类是千六，虚拟类是百二。而微信的结算周期是：当用户付款后，这笔款项会到达商户待结算余额中，当待结算余额超过500元以后，会以T+1、T+3、T+7自动结算到商家绑定的对公银行账户。

第三是银联，费率一般是千八到百一左右，计算周期是T+1自动清算到商家绑定的对公银行账户。

后面三种相对前面三种不是特别有优势的支付渠道，分别是百度钱包、京东支付、易宝支付，他们的费率基本上也是千六、千八之间，结算周期可能也是T+1。T+1是一个常见的结算周期。

最后也可以看一下他们各个支付渠道的申请周期，是从7~17个工作日不等。其中，银联的申请周期是最长的。因为银联的渠道申请入网都是要走线下，纸质合同以及相应企业资质复印件需要邮寄，而支付宝、微信在线上无纸化就可以完成全部渠道入网申请，所以银联的申请周期是较长的。

**（2）用户体验**

前面说到选择支付渠道有三块一个是成本，成本刚才已经跟大家简单分享了一下。下面说的是第二个：用户体验。用户体验我们简单理解一下就是，每个用户对借记卡和贷记卡的偏爱是不同的，有的人喜欢信用卡，有的人喜欢借记卡，而且对银行的选择也是众口难调。所以，为了带来较好的用户体验，往往选择支付渠道的时候选择银行通道比较多的支付产品。从这点来说，银联、支付宝、微信支付这些渠道拥有比较大的优势。另外，同一个渠道不同的产品，他的用户体验差异也是比较大的。比如支付宝的移动支付和支付宝的手机网页支付，简单理解就是支付宝的App支付和Wap支付，支付体验前者优势是非常明显的。

**（3）订单转换率**

第三个是支付订单的转换率方面，订单转化率也就是说订单支付成功率。一般而言，支付渠道的成功率越高的话，那么订单的转换率会越高。

综上，**企业在做支付渠道选择的时候需要筛选和权衡利弊**。

### 2、支付产品

在这里，简单列举了一下支付宝和微信支付当前所有收款端支付产品和我们一般付款的产品。**不同的支付产品对应着不同的支付场景，企业选择支付产品时需要结合自身的支付场景进行筛选**，我们可以简单过一下。

**（1）收款产品**

![img](http://image.woshipm.com/wp-files/2016/08/gongkaike_160721_ppt_-3.jpg)

支付宝的支付产品我们可以从线上和线下两个方面去看：

线上分为PC端和移动端，PC端分别是即时到账和扫码支付。我简单介绍一下即时到账，买家付款后直接到商家的企业账户，这是支付宝PC端的一个主要支付产品。扫码是可以涵盖PC端、移动端和线下三个场景的。线上的另一端——移动端，移动端的收款产品相对较多，比如扫码支付和条码支付分别是扫码支付的主扫和被扫模式。另外就是我们现在比较少见少用的声波支付，再加上移动支付（商家在App中集成支付宝SDK），最后一个是移动支付宝的手机网站支付（用户在手机设备上通过H5网页支付完成付款）。

第二大收款产品是线下移动端，分别也是扫码支付的主扫和被扫模式。这是支付宝收款产品线上和线下的列举。

![img](http://image.woshipm.com/wp-files/2016/08/gongkaike_160721_ppt_-4.jpg)

同理微信支付，因为是对标关系，在线上线下产品设计上同支付宝有较大的重合性。不同的是在线上PC端，微信少了一个即时到账，因为对自己的定义是移动端产品，所以对线上支持是比较少的。我们现在能在线上进行微信支付的就只有扫码支付。在移动端有刷卡、扫码，这和支付宝的名称有点不一样，但他们都是扫码的主扫和被扫模式。再者就是App支付和公众号支付，公众号支付就是在微信内置浏览器里面可以调取微信支付相应控件完成支付。再者就是线下，也是主扫和被扫。

**（2）付款产品**

第三个就是我们看一下主流付款产品的简介：

![img](http://image.woshipm.com/wp-files/2016/08/gongkaike_160721_ppt_-5.jpg)

付款产品我们按主体和到款时间分为两类。从主体上来说分为两类，一个是付款到自己的，就是提现，即从我的支付宝余额里面，把余额提现到我的银行卡里面；第二个就是代发，代发就是提现到别人的银行卡。到账时间分T+0和T+N，这个可能会根据支付渠道各自跟银行的对接能力不同，而有所变动。

### 3、接入支付系统

在前面，我们选择好支付渠道和相应支付产品之后，接下就是与支付系统的对接。一般的流程是渠道申请、接入开发、测试联调、产品上线、迭代开发。

![img](http://image.woshipm.com/wp-files/2016/08/gongkaike_160721_ppt_-7.jpg)

上面这张图是我在网上截取的一张B2C网关支付业务流程图，包括正向支付和逆向退款。其他支付产品的业务流程是其实是比较相似的，所以我这里只是简单介绍一下。但我 会比较详细的跟大家讲述一下退款，因为正向支付是一个比较常见的流程，可能大家比较清晰了。

**退款**

昨天看到天天问答上收集问题时，有人对退款这一块比较有兴趣，所以我说一下退款。退款这一块，其实退款的真正主体是商户，在用户向商户发起的退款请求之后，商户会登入相应的支付平台，或者是通过支付公司提供的退款接口向支付平台发起退款，支付系统在接收到这些退款信息之后进行校验。比如，退款订单对应的原有订单是否支付成功了？退款金额是否小于等于原订单金额？在校验一下商户账户余额是否充足？如果校验通过则发起退款，如果校验不通过是无法发起退款的。**发起退款的时候，支付系统在商户可用余额账户里扣除金额，并将退款订单发送到银行，银行完成退款操作，这就是一个完整的退款业务流程。**

以上是最基础的企业支付接入流程。其实**作为一个产品经理，设计支付产品的时候，更多是要依赖于公司集团的发展阶段，对支付产品的设计策略以及方案也是有所不同的**。

**收款**

那么除了收款需求外，企业是否还有别的支付需求呢？刚才我们讲的收款是一个功能，用于支付，支付一般就是C2B、B2B。我这里解释一下，后面所有讲到的C2B、B2B以及相关方面是按照资金流向介绍的。C2B、B2B简单介绍一下就是说资金从C端流向了B端，或者是从B端流向了另外一个B端。

支付就是C2B、B2B的一个资金流向，对应到的就是企业用户付款或者是个人用户付款，这是收款这块的功能。

![img](http://image.woshipm.com/wp-files/2016/08/gongkaike_160721_ppt_-9.jpg)

**付款**

收款完以后，后面还有付款。付款比如说有B2C微信企业红包，还有银联的代付，它是B2C或者B2B的一个企业付款。B2C比如举一个场景就是直播平台的主播提现；B2B的企业付款，比如是企业间进行交易往来。除此之外还有一些与支付强关联的功能，比如说身份证，在前不久6月28日国家网信办发布了移动应用者开发者管理规定，要求8月1日起所有App都要施行实名认证。除了实名认证之外，还有一些比如海淘企业需要报关、物流查询的服务这些都是一个个比较独立的功能点。

但是，大家知道功能性产品只是一个工具，工具的粘性是比较低的。即使是当前支付工具中最厉害的支付宝，其使用频率也不是很高。

那么如何设计支付产品加深用户的联系呢？支付其实是依托于具体支付场景的，所以**搭建合适的支付场景，在场景中吸引和沉淀用户，是支付产品设计的必经之路**

## 支付场景

场景就是一个一个功能点的有机结合。刚才我们看到C2B、B2B、B2C，我们总结下来就是有C2B2C、C2B2B两种场景，比如说C2B2C有打赏、直播、红包，这些都可以增强用户的粘度、互动、存在感。而C2B2B就是比较传统的模式，比如说二级商城。接下来我会对各种场景化做详细分析和介绍。

![img](http://image.woshipm.com/wp-files/2016/08/gongkaike_160721_ppt_-10.jpg)

**（1）打赏**

打赏最常见的前端场景就是，用户向服务或内容提供方付费。场景比如大家觉得这个人他的文章写得不错要进行打赏，这个内容提供方可以是企业或者个人。那么我们对这个场景进行业务拆分的话就是三块：第一块是平台向个人用户收款；第二块是平台向内容提供方付款；第三块是需要一个余额管理功能。进行拆分的话，资金流向首先是C2B然后B2C，也就是首先个人用户到平台账户，再从平台转至服务提供商，这是我们对打赏的一个分析。

![img](http://image.woshipm.com/wp-files/2016/08/gongkaike_160721_ppt_-11.jpg)

**（2）直播**

直播是去年末到今年比较火的。因为我们是一个聚合支付品牌，所以互联网的很多一些新兴的支付模式，支付需求都是我们提供服务，我们的聚合支付服务有比较多直播客户。去年的时候，我们发现平台一两点钟的交易频度是比较低的。但是今年开始，四点钟以前他的热度是下不去的，三四点之前也是直播用户上线的主要时刻。那么他的前端场景是用户向服务或内容提供方付费。他的业务拆分也是收款、付款、余额管理，但是他会多一个在上图中看到的身份认证。这个身份认证，大家都懂的，由于最近直播场景出现了一些小小的问题，在监管层面上做了一些相应的控制，对主播都进行实名认证。我们将收款、付款、余额管理、身份认证这四个功能点有机结合就组成了直播的场景。一般直播平台的资金流向也是C2B2C。

![img](http://image.woshipm.com/wp-files/2016/08/gongkaike_160721_ppt_-12.jpg)

**（3）红包**

红包比较简单，红包的场景一般来说我要发红包、我要收红包，收完红包后可能还会存在提现的需求。这个主要就是收款、付款，当然还需要一个账户体系。在红包内资金变化他并不是真正的银行账户或者支付账户的资金变化，仅仅是平台下个人虚拟账户的金额变化，所以必须要为平台配套一个相应的账户体系。资金流向可能是C2B2C，也可能是B2C也就是企业直接向用户发红包，这也是去年末到今年上半年比较热的一个场景。

![img](http://image.woshipm.com/wp-files/2016/08/gongkaike_160721_ppt_-13.jpg)

**（4）二级商城**

二级商城的前端场景主要是，多个商户通过平台进行统一销售，需要一个二级商户体系，再加上收款、付款，以及可能像京东这样的商城也会存在一个资金归集的需求，在资金归集之后可能还存在对他下面的二级商户进行结算。二级商户资金流向主要是C2B2B。

刚才总共讲了4个支付场景。综上所述，**在设计支付产品时，不应该单纯的只提供功能，而是要把功能组合成有效的场景，这个对用户的粘性提升和付费意愿也是一个比较大的改善。**

![img](http://image.woshipm.com/wp-files/2016/08/gongkaike_160721_ppt_-14.jpg)

## 企业支付需不需要SaaS?

接下来跟大家分享一个老生常谈的事情，我们企业在接入服务的时候到底是自己做呢，还是选择想SaaS这样的服务产品。很多刚刚开始创业或者早期团队，他们以为支付系统只需要对接相应的渠道，比如微信、支付宝、银联等等这些渠道一个一个接入就好了，只要有时间和人力就可以实现。如果由于快速接入的需求，可能会使用SaaS服务商提供的产品。但是，在业务发展到一定阶段的时候，他可能会自己切回去，实际情况真的是这样吗？

![img](http://image.woshipm.com/wp-files/2016/08/gongkaike_160721_ppt_-16.jpg)

其实我们并不是这么看的，真实的支付系统是什么样的呢？支付接入紧紧是功能模块之一，当业务形成一定规模的时候，支付可能成为核心业务系统的一块。成功率、体验、费率、安全性等等都会成为其业务核心之一的能力。同时，基于像运营、风险等加入的考量一般也会接入比较多的支付平台，一方面能为用户提供多种选择，另一方面能在多个渠道之间做路由交换。那么我们可以看到，在做支付系统架构整体规划上面，这个支付系统可能包括基础的支付系统、账户系统以及账务系统，多个渠道之间的路由系统以及清算系统，还有相应的风控和反欺诈系统，以及相应的运营系统。所以，这才是完整的支付平台的相关功能，支付不仅仅是渠道对接的简单功能实现。如果从这个层面来看的话，自己做支付系统是耗时耗力的，人力和成本的投入就不是一个小小可计量的单位了。

这里跟大家做一个小小的比较，仅从最简单的支付接入上来对比，支付SaaS能带来怎么样的便利呢？我们看一下上面和下面的区别。

![img](http://image.woshipm.com/wp-files/2016/08/gongkaike_160721_ppt_-17.jpg)

一家中小企业在对接支付服务的时候，如果他需要和支付渠道一一对接，他工作量可能存在一个累加的关系。但他如果使用SaaS公司提供的支付服务，那只需要一点式的和SaaS公司接入服务就可以对接到所有的支付渠道。所以简单理解一下，SaaS服务能带来怎样的便利服务呢？第一个，一点接入所有主流的支付渠道。第二个，一站式提供相关的支付服务。

## 常见问题

最后跟大家分享一下常见的问题以及应对办法：

### 大额分单

首先大家看一下，这是我在一个App中截的图，可以看一下画红线的部分，当订单金额达到比较大的程度的时候，他这里提示可以在“收银台”选择多次支付，在订单页面多次分单支付。简单理解一下，在一些特殊的支付场景，像海淘他们有一些关系的政策，可能要进行一些拆单、分单，因为在一定金额以内的支付是不需要纳税的，但是在一定金额以上是需要缴税的。为了合理避税，会有一个拆单需求。第二个是互金行业，互联网金融行业理财一般来说他们的订单金额是比较高的，但是由于用户银行卡快捷支付限额，常常导致支付失败，你想订单转化和用户体验。所以一般要先做好分单的规划和有效引导用户进行付费。

![img](http://image.woshipm.com/wp-files/2016/08/gongkaike_160721_ppt_-18.jpg)

### 支付路由

第二个是我在某平台上购票时发现的一个痛点。

![img](http://image.woshipm.com/wp-files/2016/08/gongkaike_160721_ppt_-19.jpg)

在支付的时候发现它接入的渠道是非常丰富的，数了一下差不多有18个渠道。但是在一个支付页面上进行显示，用户在选择的时候，只看到前面两三个支付选项，就不会往下滑了。这里是需要一个支付路由系统的，用于支付渠道选择和优化。简单点说，一个从费率上设定支付路由规则，第二个对用户的交易历史做一个记录，然后根据用户的支付习惯推荐一个相应支付渠道，其实在最后支付页面的时候，一般4~5个支付选项是能够忍受的极限。这里就少了一个支付路由的设计。

### 支付服务稳定性

第三个是我们在接入支付服务的时候，常常要考虑服务的稳定和可持续性，尤其是支付业务的可贵性，不要因为投入小而去触碰灰色地带。

![img](http://image.woshipm.com/wp-files/2016/08/gongkaike_160721_ppt_-20.jpg)

这里大家可以看到两个截图，分别是某一家支付服务商被微信支付停了所有的支付接口。第二个大家可以看到这个二维码上方，支付宝被一张白色的纸给覆盖了，也就是支付宝把这个支付服务商的渠道也给断了。

在这里跟大家分享一下就是说，现在第一批支付牌照续牌还没完成的情况下，以及央行监管层对违规进行结算服务，像二清的这种模式，严厉打击的监管背景。大家在接入相应支付服务，选取相应的支付服务商时，一定要看一下他们的模式，要保证你的支付服务是稳定和可持续性的。

其实关于支付能够讲的有很多，今天只能和大家分享其中的冰山一角，因为时间的关系也只能浅尝辄止，后面如果大家有兴趣，我们可以在线上和线下细聊，届时也请大家多多指教。

## 以下是小伙伴现场提的一些问题：

### Q：马上要实行的所有支付渠道改成相同费率会对一些行业造成影响吗？

A：我理解一下所有渠道改成相同费率，描述可能不是很准确。其实费改主要是线下收单，线下收单就是我们常规意义上说的pos收单。以前pos收单领域可能会根据不同行业有相应的区分，餐饮业商家、百货商店、超市、三农业务的手续费率分别为1.25%、0.78%、0.38%和0.25%。分为四档费率，在今年9月6号后这些行业的费率会统一化。这个费改政策除了对发卡行、转接机构像银联这边做了相应的限制，规定费率上限之外，收单机构和商户间费率的谈判是市场化的，没有做严格的限制。单丛费率影响上来说，可能影响不会特别大。

### Q：P2P行业支付该如何取舍才好，是接入银行还是第三方支付？

A：现在银行he 第三方支付机构对P2P的审核 比较严格，特别是比较大型的第三方支付公司。微信、支付宝明确对相关经融类行业服务完全关闭申请通道。在这里可能没有太多相应的选择，部分第三方支付机构对P2P相对放宽限制，所以这里就是有什么接什么，暂时不存在选择的余地。

### 

### Q：好多支付公司没有支付牌照也可以支付是否违规？

A：支付服务的合规性，第一个主要看在支付服务的时候是否实名入网，第二个作为平台的话最好不要碰到资金的结算（二清），严守底线基本是不会违规的。如果这两条线都踏过是有违规的风险。

### 

### Q：微信支付服务商在扩张支付渠道中有低费率的优势，这种情况Ping++ 如何应对？

A：微信支付服务商可能有返点，目前有些微信服务商过得很滋润。但是，Ping++ 的定位是独立客观的第四方，关于费率这一块，我们是不去碰触的。商户和支付渠道方进行协商和谈判，如果商户有较大的议价能力，可以拿到比较低的费率优势。Ping++ 目前不会主动碰触费率谈判。那么关于对比的话，现在有一个比较好的政策环境是监管层对于二清的服务模式打压非常严厉，而且大家也看到，最近微信支付把3000多家服务商模式的微商给一刀切了，所以说商户的支付需求，其实更应该跟Ping++ 这样的阳光支付服务商进行结合。支付是一件细水长流的事情，不要为了一些短期利益，而去冒着踩线的风险。追求安全和稳定应该是所有的前提条件。

### Q：支付宝、微信支付后退款是推到绑定的银行卡么？

A：一般来讲退款是原路退回。当原路退回无法退回的时候，才回退回到用户指定的某张银行卡账户，或者支付宝余额、微信零钱都有可能。

### 

### Q：第三方支付牌照和第三方支付公司界定是什么？

A：这个……这个问题比较奇怪，一般来讲具有第三方支付牌照我们才将他称作第三方支付公司，在他们之间是一个资质的问题。或者说第三方支付公司具有相应的某一张或多张支付牌照。

### Q：大的支付证明处理，比如买个理财是50W，跳到收银台的时候银行卡上线只有20W，证明处理？

A：这个就是刚才说过的要进行分单处理。商户要很好的引导用户完成支付。

### 

### Q：微信、支付宝的资金分账有什么接口？

A：在3月份参加了微信在上海举办的开发者大会。开发团队介绍在后期会上一个分账功能，但是他的分账功能比较弱。我理解一下这个分账功能，企业把相应的资金分到不同的B端或者C端。这一块微信和支付宝也有相应的接口，但这个接口只在微信、支付宝进行内部账户资金流转。比如支付宝有一个批量转账到支付宝账号的接口，可以从支付宝企业账号流出到另一个支付宝企业账号或者个人账号。微信有一个微信企业付款或者微信企业红包接口，可以从微信企业账户将资金转移到个人零钱账户里面。

### 

### Q：有没有相关的书籍推荐？

A：我个人比较喜欢，网名风吹江南的一些自媒体文章。一些相应的书籍比如《支付战争》、《支付革命》、《风吹江南之互联网金融》。如果大家对支付这一块比较有兴趣的话，也可以看一下比较基础的比如《电子支付与结算》等等之类的书籍，也是一个比较好的入门途径。

### Q：如果产品也有虚拟货币体系，需要加入第三方支付的微信，同时存在两套支付系统，该如何处理？

A：这个问题我没太理解，这个问题我们场景化说一下，比如说我们的客户映客，他是有虚拟货币体系的，比如你用支付宝或微信充值的时候，购买的是一个虚拟货币，叫做映客钻石，这是映客的虚拟货币体系。但是和第三方支付微信、支付宝是不冲突的，不存在两个支付系统，他们之间也不存在耦合或关联。

### Q：在你看来快捷支付产品和传统网银产品本质上有什么不同？

A：这个问题好像之前也遇到过，说下个人理解，传统网银产品和快捷支付产品，我们理解的快捷支付产品一般是第三方快捷支付产品。当然现在银行也推出了一些类似快捷产品，像招行一网通产品。但是我狭隘理解一下，这个快捷支付产品理解成像支付宝、微信的快捷支付，传统网银产品本质上的不同，我觉得是两块，一个是鉴权的主体，二个是风险承担的主体。这两块的不同，像传统网银的产品他的鉴权和风险承担都在银行这边。快捷支付这一块鉴权除第一次签约是在银行的这一端，后面的每一次鉴权都是在第三方机构，相应的风险转嫁，也转到第三方机构这边。这是我认为他们本质的不同。

### 

### Q：使用支付宝无密支付接口怎么避免安全风险？

A：我理解一下无密支付是不是小额免密，安全与便捷一直是矛盾与冲突的，在不同的支付场景下面，对安全与便捷的平衡是不一样的。一般来讲对于小额支付场景，如生活服务类支付场景，做小额免密，牺牲一定的安全提升相应的便捷这个也是可以理解。我个人不太喜欢，还是希望有确认消费意愿的步骤，所以把所有的小额免密授权关闭了。



![image-20191121143848911](C:\Users\aq\AppData\Roaming\Typora\typora-user-images\image-20191121143848911.png)

### 企业客户：

以公司机构类型注册成为支付平台的用户被定义为企业客户 。 

原则上当一个企业客户具备收单条件并接入了对应支付产品后，则默认成为商户 。 

例如某电商公司为接入支付，注册成为了支付宝的企业账户并开通收款功能，这时候即可将该电商平台定义为支付宝的收单商户

### 企业客户关键字段：

会员ID 、 三证一照 、 法人信息 、 企业名称 、 商户信息(产品权限 、 接口权限)

## 个人客户： 

以个人类型注册成为支付平台的用户被定义为个人客户，一个用户仅拥有一个会员ID，一般在电商平台，C端用户注册时会同步一个UID到支付系统内部的会员系统，同时开通一个支付会员，且对应开通一个基本账户，便于后期发展钱包业务 。 

个人客户关键字段 ：

会员ID、姓名、证件类型、证件号。 





聚合支付

商户入网  子商户

通过Ping++接口 查看Ping++数据库设计

Application 应用

商户获取appId  appSecret



ping++数据库设计

App应用

appId appSecret



app_user  一个应用会有多个用户

User 用户

用户分为customer business



app_id  id address avatar email gender

mobile name metadata parent_user_id

查询通过 app_id  user_id



用户结算账号SettleAccount

id created channel recipient

 结算账号渠道名称，目前支持：`alipay`（支付宝）、`wx`（微信 App）、`wx_pub`（微信 JSAPI）、`wx_lite`（微信小程序）、`bank_account`（银行卡）。 

```
{
  "id": "320217022818035400000601",
  "object": "settle_account",
  "created": 1488276234,
  "livemode": true,
  "channel": "bank_account",
  "recipient": {
    "open_bank_code": "0102",
    "account": "622262***2145",
    "name": "***哥"
  }
}
```

账号表设计

按照渠道划分分为支付宝 微信 银行卡等设计

如果是支付宝 按照转账类别设计为 b2c  b2b

按照收款方账号分为  收款方账户类型。默认值："ALIPAY_LOGONID"。ALIPAY_USERID：支付宝账号对应的支付宝唯一用户号，以 2088 开头的 16 位纯数字组成；ALIPAY_LOGONID：支付宝登录号，支持邮箱和手机号格式。 



如果是微信

account为openId

如果是银行卡

| 参数                               | 描述                                                         |
| :--------------------------------- | :----------------------------------------------------------- |
| account**REQUIRED***string*        | 接收者银行账号/卡号。                                        |
| name**REQUIRED***string*           | 接收者银行开户名。                                           |
| type**REQUIRED***string*           | 转账类型。`b2c`：企业向个人付款，`b2b`：企业向企业付款。     |
| open_bank_code**REQUIRED***string* | 开户银行编号（针对 chanpay / allinpay / unionpay 渠道使用），请根据渠道的不同参考 [银联电子代付银行编号说明](https://www.pingxx.com/api/银联电子代付银行编号说明.html) 、[通联代付银行编号说明](https://www.pingxx.com/api/通联代付银行编号说明.html) 或 [畅捷代付银行编号说明](https://www.pingxx.com/api/畅捷代付银行编号说明.html)。 |
| open_bank*optional**string*        | 开户银行名称（针对 unionpay 渠道使用）。                     |
| card_type*optional**int*           | 银行卡号类型，0：银行卡；1：存折；2：信用卡；3：准贷记卡；4：其他。（jdpay 不支持 1。chanpay 不支持 1、3、4） |
| sub_bank*conditional**string*      | 开户支行名称，1~80位（针对 allinpay / unionpay 渠道使用）。若使用 allinpay 渠道且 type 为 b2b，则此参数必填，详情请下载 [支付行号](https://www.pingxx.com/api/download/支付行号.xlsx) 。 |
| sub_bank_code*conditional**string* | 支付行号（仅针对 allinpay 渠道使用），1~12位，且在 type 为 b2b 时此参数必填，详情请下载 [支付行号](https://www.pingxx.com/api/download/支付行号.xlsx) 。 |
| prov*conditional**string*          | 开户银行所在省份，（针对 allinpay / unionpay / chanpay 渠道使用）。若使用 allinpay、chanpay 渠道且 type 为 b2b，则此参数必填。`allinpay`渠道此参数要求：不带 “省” 或 “自治区”，需填写成：广东、广西、内蒙古等，详情请参考 [中国邮政区号表](https://www.pingxx.com/api/download/中国邮政区号表.xls) 内的「省洲名称」列的内容填写。`chanpay`渠道此参数要求：参考 [畅捷代付省市列表](https://www.pingxx.com/api/download/畅捷代付省市列表.xlsx) 内的「prov」列的内容填写。 |
| city*conditional**string*          | 开户银行所在城市，（针对 allinpay / unionpay / chanpay 渠道使用）。若使用 allinpay、chanpay 渠道且 type 为 b2b，则此参数必填。`allinpay`渠道此参数要求：不带 “市”，需填写成：广州、南宁等。如果是直辖市，则填区，如北京（市）朝阳（区），详情请参考 [中国邮政区号表](https://www.pingxx.com/api/download/中国邮政区号表.xls) 内的「地区名称」列的内容填写。`chanpay`渠道此参数要求：参考 [畅捷代付省市列表](https://www.pingxx.com/api/download/畅捷代付省市列表.xlsx) 内的「city」列的内容填写。 |





银行卡支行信息查询

sub_bank  sub_bank_code area

银行卡四要素校验接口

| **channel属性值**   | **支付渠道名称**                                 |
| :------------------ | :----------------------------------------------- |
| alipay              | 支付宝 App 支付                                  |
| alipay_wap          | 支付宝手机网站支付                               |
| alipay_qr           | 支付宝扫码支付                                   |
| alipay_scan         | 支付宝条码支付                                   |
| alipay_lite         | 支付宝小程序支付                                 |
| alipay_pc_direct    | 支付宝电脑网站支付                               |
| wx                  | 微信 App 支付                                    |
| wx_pub              | 微信 JSAPI 支付                                  |
| wx_pub_qr           | 微信 Native 支付                                 |
| wx_pub_scan         | 微信付款码支付                                   |
| wx_wap              | 微信 H5 支付                                     |
| wx_lite             | 微信小程序支付                                   |
| qpay                | QQ 钱包 App 支付                                 |
| qpay_pub            | QQ 钱包公众号支付                                |
| upacp               | 银联手机控件支付（银联 App 支付）                |
| upacp_pc            | 银联网关支付（银联 PC 网页支付）                 |
| upacp_qr            | 银联二维码（主扫）                               |
| upacp_scan          | 银联二维码（被扫）                               |
| upacp_wap           | 银联手机网站支付                                 |
| upacp_b2b           | 银联企业网银支付（银联 B2B PC 网页支付）         |
| cp_b2b              | 银联电子企业网银支付（银联电子 B2B PC 网页支付） |
| applepay_upacp      | Apple Pay                                        |
| cmb_wallet          | 招行一网通                                       |
| cmb_pc_qr           | 招行 PC 扫码支付                                 |
| bfb_wap             | 百度钱包                                         |
| jdpay_wap           | 京东支付                                         |
| yeepay_wap          | 易宝支付                                         |
| isv_qr              | 线下扫码（主扫）                                 |
| isv_scan            | 线下扫码（被扫）                                 |
| isv_wap             | 线下扫码（固定码）                               |
| isv_lite            | 线下小程序支付                                   |
| ccb_pay             | 建行 App 支付                                    |
| ccb_qr              | 建行二维码支付                                   |
| cmpay               | 移动和包支付                                     |
| coolcredit          | 库分期                                           |
| cb_alipay           | 跨境支付宝 App 支付                              |
| cb_alipay_wap       | 跨境支付宝手机网站支付                           |
| cb_alipay_qr        | 跨境支付宝扫码支付                               |
| cb_alipay_scan      | 跨境支付宝条码支付                               |
| cb_alipay_pc_direct | 跨境支付宝电脑网站支付                           |
| cb_wx               | 跨境微信 App 支付                                |
| cb_wx_pub           | 跨境微信 JSAPI 支付                              |
| cb_wx_pub_qr        | 跨境微信 Native 支付                             |
| cb_wx_pub_scan      | 跨境微信付款码支付                               |
| paypal              | PayPal                                           |
| balance             | 余额                                             |



 目前订单支持状态。分为待支付：created、已付款：paid、存在退款：refunded、已取消：canceled。 

| amount*int*        | 原始金额，单位为分。                                         |
| ------------------ | ------------------------------------------------------------ |
| coupon_amount*int* | 优惠券折扣金额，单位为分。                                   |
| actual_amount*int* | 应付金额，单位为分。值为原始金额减去优惠券折扣金额（`amount` - `coupon_amount`）。 |

| mount_paid*int*      | 已付金额，值为所有包含已付款的 `charge` 对象的 `amount` 总额，单位为分。 |
| -------------------- | ------------------------------------------------------------ |
| amount_refunded*int* | 已退金额（成功退款的金额），值为所有包含有退款的 `charge` 对象的 `amount_refunded` 总额，单位为分。 |



| currency*string* | 3 位 ISO 货币代码，小写字母，人民币为 `cny`。 |
| ---------------- | --------------------------------------------- |
|                  |                                               |

| coupon*string* | 使用的 `coupon` 对象的 `id`。 |
| -------------- | ----------------------------- |
|                |                               |

支付渠道设计

parent_chanel 主渠道信息

channel 支付渠道

id 渠道ID

name 渠道名称

sort_index 渠道排序

is_need_password 是否需要支付密码

 ![这里写图片描述](https://img-blog.csdn.net/20180102095641795) 

id 渠道主键  name 渠道名称  status 渠道状态 channel_tag app支付 网站支付



① pay_channel：可供接入的支付渠道



② app_settings：支付应用信息



③ app_channel：应用已接入的支付渠道



④ alipay_settings：支付宝参数设置


⑤ wx_settings：微信app支付参数设置


如果想要增加支付渠道，只需要添加一张对应的支付参数设置表。


业务产品 支付渠道优先级

支付渠道

chanel_name   

业务产品

用户习惯

cookie习惯

按照原始设定



select * from channel_name order by  xxx,yyy



商户开通的渠道app

app_channel

